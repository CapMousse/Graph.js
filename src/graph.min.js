class Graph{constructor(t){if(this.options={paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,showCircle:!1,circle:"#55AA77",circleSize:4,background:"#FFFFFF",showZeroLine:!1,centerZero:!1,zeroLineColor:"#EEE",lineColor:"#C5C5C5",lineWidth:3,showBounds:!1,bounds:"#8888EE",boundsHeight:14,boundsFont:"Arial",showLegend:!1,legend:!1,legendColor:"#8888EE",legendHeight:14,legendFont:"Arial"},t&&(this.options={...this.options,...t}),"object"!=typeof this.options.data&&!Array.isArray(this.options.data))throw new Error("Data is not an array");if(!this.options.target||!this.options.target.nodeName||"CANVAS"!==this.options.target.nodeName)throw new Error("Canvas not defined");this.options.context=this.options.target.getContext("2d"),this.init(),this.draw()}getPointCoordinates(t){return[this.options.paddingLeft+t*this.horizontalScale,this.middle+this.options.paddingTop-this.verticalScale*this.options.data[t]]}init(){this.options.target.height=this.options.target.parentElement.offsetHeight,this.options.target.width=this.options.target.parentElement.offsetWidth,this.options.showLegend&&(this.options.paddingLeft=this.options.paddingLeft||2*this.options.legendHeight,this.options.paddingRight=this.options.paddingRight||2*this.options.legendHeight,this.options.paddingBottom=this.options.paddingBottom||2.5*this.options.legendHeight),this.options.showBounds&&(this.options.paddingLeft=this.options.paddingLeft||this.options.boundsHeight/1.4,this.options.paddingTop=this.options.paddingTop||1.4*this.options.boundsHeight,this.options.paddingBottom=this.options.paddingBottom||1.4*this.options.boundsHeight),this.options.showCircle&&(this.options.paddingRight=this.options.paddingRight||this.options.circleSize,this.options.paddingTop=this.options.paddingTop||this.options.circleSize,this.options.paddingBottom=this.options.paddingBottom||this.options.circleSize),this.options.paddingTop=this.options.paddingTop||this.options.lineWidth,this.options.paddingBottom=this.options.paddingBottom||this.options.lineWidth}async draw(){await this.drawBackground(),await this.computeScale(),await this.drawMiddle(),await this.drawScale(),await this.drawData(),await this.drawCircle(),await this.drawBounds(),await this.drawLegend()}async drawBackground(){this.options.context.fillStyle=this.options.background,this.options.context.fillRect(0,0,this.options.target.width,this.options.target.height)}async computeScale(){this.maxValue=Math.abs(Math.max(...this.options.data)),this.minValue=Math.abs(Math.min(...this.options.data)),this.minValue!=this.maxValue&&this.options.showZeroLine&&(this.maxValue>this.minValue?this.minValue=0:this.maxValue=0),this.max=Math.max(this.maxValue,this.minValue),this.height=this.options.target.height-(this.options.paddingTop+this.options.paddingBottom),this.width=this.options.target.width-(this.options.paddingLeft+this.options.paddingRight),this.horizontalScale=this.width/(this.options.data.length-1),this.options.centerZero||this.maxValue==this.minValue?(this.middle=Math.round(this.height/2),this.verticalScale=this.middle/this.max):(this.verticalScale=this.height/(this.maxValue-this.minValue),this.middle=Math.round(this.maxValue*this.verticalScale))}async drawMiddle(){this.options.showZeroLine&&(this.options.context.moveTo(this.options.paddingLeft,this.middle+this.options.paddingTop),this.options.context.lineTo(this.options.target.width-this.options.paddingRight,this.middle+this.options.paddingTop),this.options.context.strokeStyle=this.options.zeroLineColor,this.options.context.stroke())}async drawScale(){this.options.showBounds&&(this.options.context.moveTo(this.options.paddingLeft,this.options.paddingTop),this.options.context.lineTo(this.options.paddingLeft,this.options.target.height-this.options.paddingBottom),this.options.context.strokeStyle=this.options.zeroLineColor,this.options.context.stroke())}async drawData(){const t=this.options.data.length-1;this.options.context.strokeStyle=this.options.lineColor,this.options.context.lineWidth=this.options.lineWidth,this.options.context.moveTo.apply(this.options.context,this.getPointCoordinates(0)),this.options.context.beginPath();for(let i=0;i<=t;i++)this.options.context.lineTo.apply(this.options.context,this.getPointCoordinates(i));this.options.context.stroke()}async drawCircle(){if(!this.options.showCircle)return;const t=this.getPointCoordinates(this.options.data.length-1);this.options.context.fillStyle=this.options.circle,this.options.context.beginPath(),this.options.context.arc(t[0],t[1],this.options.circleSize,0,2*Math.PI),this.options.context.closePath(),this.options.context.fill()}async drawBounds(){if(!this.options.showBounds)return;const t=this.options.centerZero?this.max:this.maxValue,i=this.options.centerZero?-this.max:this.minValue;this.options.context.font=this.options.boundsHeight+"px "+this.options.boundsFont,this.options.context.fillStyle=this.options.bounds,this.options.context.textBaseline="middle",this.options.context.textAlign="center",this.options.context.fillText(t,this.options.paddingLeft-(this.options.showLegend?this.options.paddingLeft/2:0),this.options.paddingTop-(this.options.showLegend?0:this.options.boundsHeight)),this.options.context.fillText(i,this.options.paddingLeft-(this.options.showLegend?this.options.paddingLeft/2:0),this.options.target.height-this.options.paddingBottom+(this.options.showLegend?0:this.options.boundsHeight))}async drawLegend(){const t=this.options.data.length-1;if(this.options.showLegend&&this.options.legend){this.options.context.font=this.options.legendHeight+"px "+this.options.legendFont,this.options.context.fillStyle=this.options.legendColor,this.options.context.textBaseline="middle",this.options.context.textAlign="center";for(let i=0;i<=t;i++)this.options.context.fillText(this.options.legend[i],this.getPointCoordinates(i)[0],this.options.target.height-this.options.paddingBottom/2)}}}